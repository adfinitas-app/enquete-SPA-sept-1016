function createCORSRequest(e,t){var n=new XMLHttpRequest;return"withCredentials"in n?n.open(e,t,!0):"undefined"!=typeof XDomainRequest?(n=new XDomainRequest,n.open(e,t)):n=null,n}function makeCorsRequest(e){var t="https://form-to-db.herokuapp.com/",n=JSON.stringify(e),s=createCORSRequest("POST",t);return s?(s.setRequestHeader("Content-Type","application/json"),s.onerror=function(){alert("Woops, there was an error making the request.")},void s.send(n)):void alert("CORS not supported")}function validateForm(){var e=(document.getElementsByTagName("input"),document.getElementById("f_email").value),t=/^\d{10}$/;return atpos=e.indexOf("@"),dotpos=e.lastIndexOf("."),atpos<1||dotpos-atpos<2?($(".error_mail").show(),document.getElementById("f_email").focus(),!1):($(".error_mail").hide(),document.getElementById("f_tel").value.match(t)?($(".error_tel").hide(),0==document.getElementById("f_name").value.length||0==document.getElementById("f_prenom").value.length?($(".error_np").show(),!1):($(".error_np").hide(),display_results(),$("#footer").css({display:"block"}),formToDb(),void FadeOutFormSlide())):($(".error_tel").show(),document.getElementById("f_tel").focus(),!1))}function FadeOutFormSlide(){$("#slide-end-form").fadeOut("slow",function(){"";$(".slide-end-1").fadeIn("slow",function(){})})}function SendDataToWoopra(){woopra.identify({email:document.getElementById("f_email").value,name:document.getElementById("f_prenom").value+" "+document.getElementById("f_name").value,firstname:document.getElementById("f_prenom").value,lastname:document.getElementById("f_name").value,phone:document.getElementById("f_tel").value});var e="";e=1==document.getElementById("f_check").checked?"non":"oui",woopra.track("inscription",{optin:e,url:document.location.href,title:document.title,origine:"Enquete 2016"});var t=extractUrlParams();"canal"in t?woopra.track("survey_2016",{canal:"orixa",optin:e}):woopra.track("survey_2016",{canal:"bdd",optin:e})}function formToDb(){var e=extractUrlParams(),t="",n=[],s="",a=0;t="canal"in e?"orixa":"bdd",s=1==document.getElementById("f_check").checked?"non":"oui",$(".selected").each(function(){n[a]=$(this).attr("id"),a++});var o={schema:"spa_survey_2016",db:{origin:"Enquete 2016",email:$("#f_email").val(),firstname:$("#f_prenom").val(),lastname:$("#f_name").val(),phone:$("#f_tel").val(),canal:t,optin:s,q1:n[0],q2:n[1],q3:n[2],q4:n[3],q5:n[4]}};makeCorsRequest(o)}function getMaxTableau(e){var t,n,s;for(t=1,s=0,n=0;t<e.length;)e[n]<e[t]?(n=t,s=0):e[n]==e[t]&&(s=1),t++;return 1==s?4:n}function display_results(){var e,t=["Sociable et courageux comme le chien !","Tranquille comme le chat !","Joueur comme le hamster !","Dynamique et libre comme le cheval !","Câlin comme le lapin !"],n=["L’ami sympathique par excellence, c'est vous ! Toujours présent pour sortir passer du bon temps, on sait que l’on peut aussi compter sur vous en cas de besoin. Quand vous êtes là, la bonne ambiance est toujours assurée, alors un conseil : ne changez pas ! ","On respecte votre force tranquille : vous n'avez pas besoin d'en faire des tonnes pour être remarqué(e). Comme le chat, vous faites parler de vous et ce n'est pas pour rien : vous êtes si doux !","Nous comptons tous au moins une personne infatigable dans notre cercle d'amis. Pour votre entourage, cette personne c'est vous. Très dynamique, vous êtes toujours à la recherche de nouvelles expériences et c'est vous qu'on appelle pour les idées un peu folles. Avec vous c'est sûr, on ne s'ennuie jamais ! (mais encore faut-il tenir votre rythme..)","Vous êtes celui qu'on admire pour son indépendance. Délicat, vous n'en êtes pas moins majestueux : vous imposez le respect par votre simple présence, pleine d'humilité et de bonté. A vos côtés on se sent souvent apaisé, et c'est pourquoi on recherche votre compagnie !","Personne ne vous résiste : quelques minutes en votre compagnie suffisent à être touché par votre grand coeur. Vous êtes d'une rare douceur, ne vous étonnez pas si on se bat pour vous !"],s=["https://soutenir.la-spa.fr/?cid=143","https://soutenir.la-spa.fr/?cid=143","https://soutenir.la-spa.fr/?cid=143","https://soutenir.la-spa.fr/?cid=143","https://soutenir.la-spa.fr/?cid=143","https://soutenir.la-spa.fr/?cid=143"],a=["La SPA compte les chiens par milliers dans ses refuges. Chaque jour, nos experts parcourent la France pour sauver des animaux de la détresse, et leur offrir les meilleures conditions d'accueil. Vous aussi, protégez nos petits compagnons.","La SPA compte les chats par milliers dans ses refuges. Chaque jour, nos experts parcourent la France pour  sauver des animaux de la détresse, et leur offrir les meilleures conditions d'accueil. Vous aussi, protégez nos petits compagnons.","Les refuges de la SPA accueillent des chiens et chats, mais aussi des chevaux et d’autres animaux encore. Chaque jour, dans toute la France, nos équipes secourent et prennent soin des animaux en détresse. Vous aussi, protégez nos petits compagnons.","Les refuges de la SPA accueillent des chiens et chats, mais aussi des rongeurs (et bien d’autres animaux encore) ! Chaque jour, nos experts parcourent la France pour sauver  des animaux de la détresse, et leur offrir les meilleures conditions d'accueil. Vous aussi, protégez nos petits compagnons.","Les refuges de la SPA accueillent des chiens et des chats mais aussi des lapins (et bien d’autres animaux encore). Chaque jour, dans toute la France, nos équipes secourent et prennent soin des animaux en détresse. Vous aussi, protégez nos petits compagnons."],o=["https://s3.amazonaws.com/heroku-adfinitas-campaign/SPA-donor-journey-sept-2016/img-resultat-chien.png","https://s3.amazonaws.com/heroku-adfinitas-campaign/SPA-donor-journey-sept-2016/img-resultat-chien.png","https://s3.amazonaws.com/heroku-adfinitas-campaign/SPA-donor-journey-sept-2016/img-resultat-chien.png","https://s3.amazonaws.com/heroku-adfinitas-campaign/SPA-donor-journey-sept-2016/img-resultat-chien.png","https://s3.amazonaws.com/heroku-adfinitas-campaign/SPA-donor-journey-sept-2016/img-resultat-chien.png"];e=get_results(),$("#input_title").html(t[e]),$("#input_description").html(n[e]),$("#input_link").attr("href",s[e]),$("#input_support").html(a[e]),$("#input_img").attr("href",o[e])}function get_results(){var e=[0,0,0,0];return $(".selected").each(function(){e[$(this).attr("value")]+=1}),getMaxTableau(e)}function select(e){var t,n;return""==$(e).attr("src")||-1!=$(e).attr("src").search("selected")?!1:(n=$(e).attr("src"),t=n.length,n=n.substring(0,n.length-4)+"-selected.png",$(e).attr("src",n),!0)}function unselect(e){var t,n;return""==$(e).attr("src")?!1:(n=$(e).attr("src"),t=n.length,n=n.substring(0,n.length-13)+".png",$(e).attr("src",n),!0)}function preload(){for(i=0;i<preload.arguments.length;i++)images[i]=new Image,images[i].src=preload.arguments[i]}function vertical_center(e){var t,n,s;t=$(e).height(),n=$(e).parent().height(),s=(n-t)/2-20,$(e).css({"padding-top":s})}function scrollTo(e){return 0!=$(e).length?($("html, body").stop().animate({scrollTop:$(e).offset().top+1},700,"swing"),!1):void 0}$(window).scroll(function(e){var t=$(".fixedElement"),n="fixed"==t.css("position");$(this).scrollTop()>0&&!n&&$(".fixedElement").css({position:"fixed",top:"0px"}),$(this).scrollTop()<0&&n&&$(".fixedElement").css({position:"static",top:"0px"})}),$("#start_button").click(function(){$("#sticky-logo").fadeIn("slow",function(){})}),$(".stop-sticky").click(function(){$("#sticky-logo").fadeOut("slow",function(){})});var images=new Array;$(window).resize(function(){$(".question_container").each(function(){vertical_center($(this))})}),$(".question_container").each(function(){vertical_center($(this))}),preload("https://s3.amazonaws.com/heroku-adfinitas-campaign/SPA-donor-journey-sept-2016/Q1-1-selected.png","https://s3.amazonaws.com/heroku-adfinitas-campaign/SPA-donor-journey-sept-2016/Q1-2-selected.png","https://s3.amazonaws.com/heroku-adfinitas-campaign/SPA-donor-journey-sept-2016/Q1-3-selected.png","https://s3.amazonaws.com/heroku-adfinitas-campaign/SPA-donor-journey-sept-2016/Q1-4-selected.png","https://s3.amazonaws.com/heroku-adfinitas-campaign/SPA-donor-journey-sept-2016/Q2-1-selected.png","https://s3.amazonaws.com/heroku-adfinitas-campaign/SPA-donor-journey-sept-2016/Q2-2-selected.png","https://s3.amazonaws.com/heroku-adfinitas-campaign/SPA-donor-journey-sept-2016/Q2-3-selected.png","https://s3.amazonaws.com/heroku-adfinitas-campaign/SPA-donor-journey-sept-2016/Q2-4-selected.png","https://s3.amazonaws.com/heroku-adfinitas-campaign/SPA-donor-journey-sept-2016/Q3-1-selected.png","https://s3.amazonaws.com/heroku-adfinitas-campaign/SPA-donor-journey-sept-2016/Q3-2-selected.png","https://s3.amazonaws.com/heroku-adfinitas-campaign/SPA-donor-journey-sept-2016/Q3-3-selected.png","https://s3.amazonaws.com/heroku-adfinitas-campaign/SPA-donor-journey-sept-2016/Q3-4-selected.png","https://s3.amazonaws.com/heroku-adfinitas-campaign/SPA-donor-journey-sept-2016/Q4-1-selected.png","https://s3.amazonaws.com/heroku-adfinitas-campaign/SPA-donor-journey-sept-2016/Q4-2-selected.png","https://s3.amazonaws.com/heroku-adfinitas-campaign/SPA-donor-journey-sept-2016/Q4-3-selected.png","https://s3.amazonaws.com/heroku-adfinitas-campaign/SPA-donor-journey-sept-2016/Q4-4-selected.png","https://s3.amazonaws.com/heroku-adfinitas-campaign/SPA-donor-journey-sept-2016/Q5-1-selected.png","https://s3.amazonaws.com/heroku-adfinitas-campaign/SPA-donor-journey-sept-2016/Q5-2-selected.png","https://s3.amazonaws.com/heroku-adfinitas-campaign/SPA-donor-journey-sept-2016/Q5-3-selected.png","https://s3.amazonaws.com/heroku-adfinitas-campaign/SPA-donor-journey-sept-2016/Q5-4-selected.png","https://s3.amazonaws.com/heroku-adfinitas-campaign/SPA-donor-journey-sept-2016/Q5-5-selected.png"),$(".answer").mouseenter(function(){select($(this))}),$(".answer").mouseleave(function(){0==$(this).hasClass("selected")&&unselect($(this))}),$(".answer").click(function(){$(this).parent().find($("img")).removeClass("selected"),$(this).addClass("selected"),$(this).parent().find($("img")).each(function(){""!=$(this).attr("src")&&-1!=$(this).attr("src").search("selected")&&unselect($(this))}),select($(this)),$(this).parent().parent().parent().next().css({display:"block"}),vertical_center($(this).parent().parent().parent().next().find(".question_container")),scrollTo($(this).parent().parent().parent().next())}),$("#start_button").click(function(){$("#q1").parent().css({display:"block"}),vertical_center($("#q1")),scrollTo("#q1")}),$("#button-don").click(function(){$(".slide-end-1").fadeOut("slow",function(){$(".slide-end").fadeIn("slow",function(){})})}),$("#button-retour").click(function(){$(".slide-end").fadeOut("slow",function(){$(".slide-end-1").fadeIn("slow",function(){})})}),$(window).scroll(function(){if("block"==$("#final").css("display")){var e=$(this).scrollTop();e>=$("#final").offset().top+$("#final").outerHeight()-$(window).height()&&$("#final").prevAll().css({display:"none"})}});